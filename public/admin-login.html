<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - La Otra Politica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <div class="main-container">
        <!-- Sidebar con imagen del candidato -->
        <aside class="sidebar">
            <div class="sidebar-content">
                <div class="candidate-image-container">
                    <img src="/assets/images/profeVotos.jpg" alt="Candidato al Senado" class="candidate-image">
                    <div class="glass-overlay"></div>
                </div>
                <div class="sidebar-text">
                    <h2>La Otra Politica</h2>
                    <p>Panel de Administracion</p>
                </div>
            </div>
        </aside>

        <!-- Contenido principal -->
        <main class="main-content">
            <div class="form-container">
                <div class="form-header">
                    <img src="/assets/images/profe-senador.png" alt="La Otra Politica" class="logo">
                    <h1>Acceso Administrador</h1>
                    <p class="subtitle">Ingresa tus credenciales para continuar</p>
                </div>

                <form id="loginForm" class="glass-form">
                    <div class="form-group">
                        <label for="username">Usuario</label>
                        <input type="text" id="username" name="username" required placeholder="Ingresa tu usuario">
                        <div class="input-glow"></div>
                    </div>

                    <div class="form-group">
                        <label for="password">Contrasena</label>
                        <input type="password" id="password" name="password" required placeholder="Ingresa tu contrasena">
                        <div class="input-glow"></div>
                    </div>

                    <button type="submit" class="submit-btn">
                        <span class="btn-text">Iniciar Sesion</span>
                        <span class="btn-loader hidden"></span>
                    </button>
                </form>

                <!-- Mensaje de error -->
                <div id="messageContainer" class="message-container hidden">
                    <div class="message-content">
                        <div class="message-icon"></div>
                        <p class="message-text"></p>
                    </div>
                </div>

                <div class="back-link">
                    <a href="/">Volver al formulario de inscripcion</a>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-inner">
            <div class="footer-left">
                <img src="/assets/images/profe-senador.png" alt="El Derecho Para Todos" class="footer-logo" />
                <p class="footer-description">Educamos a quienes quieren liderar con proposito e integridad</p>
                <ul class="social">
                    <li>
                        <a href="https://wa.me/573116005672?text=Profe%2C%20quiero%20ser%20parte%20de%20La%20Otra%20Pol%C3%ADtica" aria-label="WhatsApp" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M20.52 3.48A11.94 11.94 0 0012.01 0C5.39 0 .01 5.37.01 12c0 2.11.55 4.15 1.59 5.95L0 24l6.2-1.63a11.93 11.93 0 005.81 1.54h.01c6.62 0 12-5.37 12-12 0-3.2-1.25-6.2-3.5-8.43zM12.02 21.3h-.01a9.32 9.32 0 01-4.75-1.3l-.34-.2-3.69.97.99-3.6-.22-.37A9.28 9.28 0 012.7 12c0-5.14 4.19-9.32 9.35-9.32 2.5 0 4.85.97 6.62 2.73a9.27 9.27 0 012.74 6.6c0 5.14-4.2 9.3-9.38 9.3zm5.37-6.95c-.29-.15-1.73-.85-2-.94-.27-.1-.46-.14-.65.14-.19.29-.74.94-.9 1.13-.17.2-.34.22-.63.08-.29-.14-1.23-.45-2.35-1.44-.87-.75-1.45-1.68-1.62-1.96-.17-.29-.02-.45.13-.6.13-.13.29-.34.43-.51.14-.17.19-.29.29-.48.1-.19.05-.36-.02-.51-.07-.15-.65-1.56-.89-2.13-.23-.56-.47-.49-.65-.5l-.56-.01c-.19 0-.5.07-.76.36-.26.29-1 1-1 2.46 0 1.45 1.03 2.85 1.17 3.05.14.2 2.02 3.2 4.89 4.49.68.29 1.22.46 1.63.59.68.22 1.3.19 1.79.11.55-.08 1.73-.71 1.98-1.4.24-.68.24-1.26.17-1.39-.07-.13-.26-.2-.55-.35z"/>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.instagram.com/elprofecharles/" aria-label="Instagram" class="social-link">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7zm10 2c1.66 0 3 1.34 3 3v10c0 1.66-1.34 3-3 3H7c-1.66 0-3-1.34-3-3V7c0-1.66 1.34-3 3-3h10zm-5 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zm0 2a3.5 3.5 0 110 7 3.5 3.5 0 010-7zM18 6.2a1 1 0 100 2 1 1 0 000-2z"/></svg>
                        </a>
                    </li>
                    <li>
                        <a href="https://web.facebook.com/charlesfigueroalopera" aria-label="Facebook" class="social-link">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M22 12a10 10 0 10-11.56 9.9v-7h-2.3V12h2.3V9.8c0-2.27 1.35-3.53 3.42-3.53.99 0 2.02.18 2.02.18v2.23h-1.14c-1.12 0-1.47.7-1.47 1.41V12h2.5l-.4 2.9h-2.1v7A10 10 0 0022 12z"/></svg>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.youtube.com/@ElProfeCharles" aria-label="YouTube" class="social-link">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M23.5 6.2a3 3 0 00-2.1-2.1C19.7 3.5 12 3.5 12 3.5s-7.7 0-9.4.6A3 3 0 00.5 6.2 31.7 31.7 0 000 12c0 1.9.2 3.8.5 5.8a3 3 0 002.1 2.1c1.7.6 9.4.6 9.4.6s7.7 0 9.4-.6a3 3 0 002.1-2.1c.3-2 .5-3.9.5-5.8 0-1.9-.2-3.8-.5-5.8zM9.8 15.5v-7l6.3 3.5-6.3 3.5z"/></svg>
                        </a>
                    </li>
                </ul>
                <hr class="footer-sep" />
            </div>
            <div class="footer-right">
                <div class="profile-card">
                    <img src="/assets/images/charles.png" alt="El Profe Charles" />
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Verificar si ya hay sesion activa
            const token = localStorage.getItem('adminToken');
            if (token) {
                fetch('/api/admin/verify', {
                    headers: { 'Authorization': `Bearer ${token}` }
                })
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = '/admin/dashboard';
                    }
                });
            }

            const form = document.getElementById('loginForm');
            const messageContainer = document.getElementById('messageContainer');
            const submitBtn = form.querySelector('.submit-btn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoader = submitBtn.querySelector('.btn-loader');

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                setLoading(true);

                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;

                try {
                    const response = await fetch('/api/admin/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ username, password })
                    });

                    const data = await response.json();

                    if (data.success) {
                        localStorage.setItem('adminToken', data.token);
                        window.location.href = '/admin/dashboard';
                    } else {
                        showMessage(data.message, 'error');
                    }

                } catch (error) {
                    showMessage('Error de conexion. Intenta nuevamente.', 'error');
                } finally {
                    setLoading(false);
                }
            });

            function showMessage(text, type) {
                messageContainer.classList.remove('hidden', 'success', 'error');
                messageContainer.classList.add(type);
                messageContainer.querySelector('.message-text').textContent = text;
            }

            function setLoading(isLoading) {
                submitBtn.disabled = isLoading;
                btnText.classList.toggle('hidden', isLoading);
                btnLoader.classList.toggle('hidden', !isLoading);
            }
        });
    </script>
</body>
</html>
